---
- name: Build Docker Image on Remote Server
  hosts: dev-server
  tasks:
    - name: Create a temporary directory for the repository
      ansible.builtin.tempfile:
        state: directory
      register: temp_dir

    - name: Pull GitHub repository
      git:
        repo: "https://github.com/Faisalsouz/IndustryGradeProjectI-JavaProject.git"
        dest: "{{ temp_dir.path }}"

    - name: Build Docker image
      community.docker.docker_image:
        path: "{{ temp_dir.path }}"
        name: faisalsouz/finalproj-tomcat
        tag: latest

    - name: Clean up temporary files
      file:
        path: "{{ temp_dir.path }}"
        state: absent
